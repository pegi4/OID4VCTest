"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validate = void 0;
const ConstraintUtils_1 = require("../../ConstraintUtils");
const validate = (validations) => {
    const validateResults = validations.map((validation) => mapper(validation));
    function toChecked(validation) {
        return new ConstraintUtils_1.Checked(validation.tag, ConstraintUtils_1.Status.ERROR, validation.message);
    }
    function toCheckedSuccess(tag) {
        return new ConstraintUtils_1.Checked(tag, ConstraintUtils_1.Status.INFO, 'ok');
    }
    function mapper(validation) {
        let result;
        try {
            if (validation.predicate(validation.target)) {
                result = toCheckedSuccess(validation.tag);
            }
            else {
                result = toChecked(validation);
            }
        }
        catch (error) {
            result = toChecked(validation);
        }
        return result;
    }
    const accumulateErrors = (accumulator, checked) => {
        if (checked.status !== ConstraintUtils_1.Status.INFO) {
            accumulator.push(checked);
        }
        return accumulator;
    };
    const validated = validateResults.reduce(accumulateErrors, []);
    if ((0, ConstraintUtils_1.hasErrors)(validated)) {
        return validated;
    }
    else {
        return [toCheckedSuccess('root')];
    }
};
exports.validate = validate;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vbGliL3ZhbGlkYXRpb24vY29yZS92YWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsMkRBQW1FO0FBZ0I1RCxNQUFNLFFBQVEsR0FBZ0IsQ0FBSSxXQUE0QixFQUFhLEVBQUU7SUFDbEYsTUFBTSxlQUFlLEdBQWMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFFdkYsU0FBUyxTQUFTLENBQUMsVUFBeUI7UUFDMUMsT0FBTyxJQUFJLHlCQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSx3QkFBTSxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdkUsQ0FBQztJQUVELFNBQVMsZ0JBQWdCLENBQUMsR0FBVztRQUNuQyxPQUFPLElBQUkseUJBQU8sQ0FBQyxHQUFHLEVBQUUsd0JBQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVELFNBQVMsTUFBTSxDQUFDLFVBQXlCO1FBQ3ZDLElBQUksTUFBTSxDQUFDO1FBRVgsSUFBSTtZQUNGLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQzNDLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDM0M7aUJBQU07Z0JBQ0wsTUFBTSxHQUFHLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQzthQUNoQztTQUNGO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDZCxNQUFNLEdBQUcsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQ2hDO1FBQ0QsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVELE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxXQUFzQixFQUFFLE9BQWdCLEVBQWEsRUFBRTtRQUMvRSxJQUFJLE9BQU8sQ0FBQyxNQUFNLEtBQUssd0JBQU0sQ0FBQyxJQUFJLEVBQUU7WUFDbEMsV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUMzQjtRQUNELE9BQU8sV0FBVyxDQUFDO0lBQ3JCLENBQUMsQ0FBQztJQUVGLE1BQU0sU0FBUyxHQUFjLGVBQWUsQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFFMUUsSUFBSSxJQUFBLDJCQUFTLEVBQUMsU0FBUyxDQUFDLEVBQUU7UUFDeEIsT0FBTyxTQUFzQixDQUFDO0tBQy9CO1NBQU07UUFDTCxPQUFPLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztLQUNuQztBQUNILENBQUMsQ0FBQztBQXhDVyxRQUFBLFFBQVEsWUF3Q25CIn0=